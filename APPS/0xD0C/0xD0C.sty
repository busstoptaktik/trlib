
%
% KMS technical documentation (0xD0C) style file.
%
% This is the TK version, based on initial work by
% Thomas Knudsen and Brian Pilemann Olsen.
%


%--------------------------------------------------------------------
% bibliography stuff (natbib must come before babel!)
%--------------------------------------------------------------------
\usepackage[round,sort]{natbib} % for (author, year) style citations
\bibliographystyle{plainnat}    % agu | egs | abbrvnat | unsrtnat ...
% see BIBLIOGRAPHY 1 PATCH for examples of the citation forms



%--------------------------------------------------------------------
% internationalization  (i18n) - babel, encoding etc.
%--------------------------------------------------------------------
\usepackage[danish,english]{babel}           % select base language of paper
\usepackage[utf8]{inputenc}         % encoding of this source file
\usepackage[T1]{fontenc}              % font encoding. Don't worry!
\usepackage{ae,aecompl}               % PS type 1, not bitmap fonts
\usepackage[iso,english]{isodate}
\usepackage{lipsum,balance}



%--------------------------------------------------------------------
% repair starred floats
%--------------------------------------------------------------------
%
% http://en.wikibooks.org/wiki/LaTeX/Floats,_Figures_and_Captions
%
% A bad point of those (starred, ed.) environments is that
% they can be placed only at the top of the page or on their
% own page. If you try to specify their position using modifiers
% like b or h they will be ignored.
% Add \usepackage{stfloats} to the preamble in order to alleviate
% this problem with regard to placing these floats at the bottom
% of a page, using the optional specifier [b]. Default is [tbp].
% However, h still does not work.
% To prevent the figures from being placed out-of-order with
% respect to their "non-starred" counterparts, the package
% fixltx2e [2] should be used (e.g. \usepackage{fixltx2e}).
\usepackage{stfloats,fixltx2e}



%--------------------------------------------------------------------
% graphics, pdf inclusion, and positioning/lay out
%--------------------------------------------------------------------
\usepackage[pdftex]{graphicx}
\usepackage{pdfpages}              % for inclusion of multipage pdfs
\usepackage[absolute]{textpos}
\TPMargin{0mm}
\textblockorigin{0mm}{0mm}
\setlength{\TPHorizModule}{1mm}
\setlength{\TPVertModule}{1mm}


%--------------------------------------------------------------------
% misc tweaks you may want to enable
%--------------------------------------------------------------------
\usepackage{url}                          % handle linebreaks in URLs
%\usepackage[T1]{url}                          % handle linebreaks in URLs
\urlstyle{same}       % typeset urls in current font
%\urlstyle{rm}        % typeset urls in roman, rather than monospace font
%\urlstyle{sf}        % typeset urls in sans serif
\pagestyle{plain}                        % {plain|headings|empty}
%\usepackage[fixpdftex]{xcolor}
%\usepackage{xcolor}
\usepackage{color}
\usepackage{lipsum}
\usepackage{geometry}
\geometry{verbose,a4paper,tmargin=20mm,bmargin=20mm,lmargin=20mm,rmargin=20mm}
\usepackage{verbatim}                     % "comment" environment
% see http://www.tug.org/applications/hyperref/manual.html
%\usepackage[bookmarks=false,citecolor=blue,linkcolor=red,urlcolor=red,backref=section,colorlinks=true]{hyperref}
\usepackage[bookmarks=false,citecolor=blue,linkcolor=red,urlcolor=red,backref=page,colorlinks=true]{hyperref}
%\usepackage[bookmarks=false,frenchlinks,backref=section]{hyperref}



\usepackage{enumitem}
\setlist[description]{leftmargin=8em,style=nextline}


% more stuff from TR16
\usepackage{endnotes,listings,amsmath}







\lstloadlanguages{C,sh}
\lstset{ %
%basicstyle=\ttfamily,%\scriptsize,  % the size of the fonts that are used for the code
frame=none,                       % adds a frame around the code
%breaklines=true,                  % sets automatic line breaking
%breakatwhitespace=false,          % sets if automatic breaks should only happen at whitespace
}
\lstdefinestyle{function-plain}{frame=none}

\lstdefinestyle{datatype}{
belowcaptionskip=1\baselineskip,
  breaklines=true,
  %frame=L,
  frame=none,
  xleftmargin=\parindent,
  language=C,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bfseries\color{green!40!black},
  commentstyle=\itshape\color{purple!40!black},
  identifierstyle=\color{blue},
  stringstyle=\color{orange},
}


\lstdefinestyle{function}{
  frame=none,
  language=C,
  showstringspaces=false,
  % basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bfseries\color{green!40!black},
  commentstyle=\itshape\color{purple!40!black},
  identifierstyle=\color{blue},
  stringstyle=\color{orange},
}

%\lstset{
% breaklines=true,
% breakatwhitespace=true,
% breakindent=2ex,
% postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\hookrightarrow\space}}
%}





\usepackage{tikz}
\newcommand{\Helplines}{
        \draw[help lines,xstep=.1,ystep=.1] (0,0) grid (1,1);
        \foreach \x in {1,2,...,9} { \node [anchor=north] at (\x/10,0) {0.\x}; }
        \foreach \y in {1,2,...,9} { \node [anchor=east] at (0,\y/10) {0.\y}; }
}
\providecommand{\helplines}{\Helplines}
\renewcommand{\helplines}{\null}

\newcommand{\imagenode}[2]{
\node[anchor=south west,inner sep=0] (image) at (0,0) {\includegraphics[width=#2]{#1}};}



%\setlength{\parskip}{0ex plus 2ex}



\renewcommand{\bibsection}{\section*{Bibliography}}
\renewcommand{\lipsum}[1][1]{\null}
\hyphenation{vand-stands-stig-nings-tak-ten}



% http://dcwww.camd.dtu.dk/~schiotz/comp/LatexTips/LatexTips.html
% LaTeX's figure placement algorithm is quite biased in favor of putting figures on a page by themselves, instead of on the top of a page with some text below it. Often, I find the result esthetically unappealing (to be polite). Fortunately, the parameters of the algorithm can be changed. The main problem is that LaTeX per default only allows a part of the top of a text-page (70%) to contain figures, and requires at least 20% of a page to be text when text and figures share a page. These parameters should be set to more reasonable values, for example 85% and 10%.
\renewcommand{\topfraction}{0.85}
\renewcommand{\textfraction}{0.1}
% This helps, but sometimes LaTeX puts a figure on a page by itself, although it would fit perfectly well on the top of a page. This happens when the figure will not fit on the page where it was defined. LaTeX then attempts to put it on a figures-only page before it attempts to put it at the top of the next page. A page may contain figures alone if the figure(s) use at least half the page. To prevent half-empty pages this limit should probably be increased to around 75%.
\renewcommand{\floatpagefraction}{0.75}
% Be careful not to make \floatpagefraction larger than \topfraction, then you risk to produce a figure that can neither go on the top of a text page, nor on a page by itself. If that happens, the figure and all later figures will be postponed until next time a \clearpage is executed (typically at the end of a chapter or the end of the document). This will also happen if a figure is too large to fit on a page.


% http://www.fauskes.net/nb/latextips/
% Sometimes you want to disable section numbering but still need to generate a table of contents, or you want to have bookmarks in the generated PDF file. Add this code at the start of your document, and your problem is solved:
\setcounter{secnumdepth}{-1}










%--------------------------------------------------------------------
% select base font set
%--------------------------------------------------------------------
\usepackage{mathptmx,courier}\usepackage[scaled=0.92]{helvet}%beauty!



\addtolength{\columnsep}{3mm}
\newcommand\technicalreporttext{0xD0C\ } % use this to replace the "Technical Report" title

% handle product name part of the "SYNOPSIS ::= NAME ' -- ' SUMMARY" pattern.
\providecommand\theproductname{\null}
\newcommand{\product}[1]{%
    \expandafter\renewcommand{\theproductname}{#1}%
}

% then handle the summary part
\providecommand\thesummary{\null}
\newcommand{\summary}[1]{%
    \expandafter\renewcommand{\thesummary}{#1}%
}


\providecommand{\SECTION}[1]{\subsection{#1}}




%--------------------------------------------------------------------
% generate colophon
%--------------------------------------------------------------------
\providecommand{\reportType}{Technical Report}
\providecommand{\ISBNidentification}{not assigned}
\providecommand{\publicationdate}{DEFINE THE PUBLICATIONDATE SYMBOL}

\makeatletter
\providecommand{\colophonstart}{%
{%
\small\null\vfill\noindent\hrulefill\thispagestyle{empty}\\%
\noindent%
\small\@author\\%
\@title \\%
\\%
\noindent%
Danish Geodata Authority, GST.
Technical documentation series%
%ISBN \ISBNidentification\\%
\noindent%
%\reportType\\%
%Published \publicationdate\\%
}%
}
\makeatother


%--------------------------------------------------------------------
% support inclusion of externally provided pdf papers (for proceedings etc.)
%--------------------------------------------------------------------
\makeatletter
\newcommand{\addinfo}{%
    \phantomsection%
    \addcontentsline{toc}{section}{%
        \@title\\\emph{\scriptsize \@author}}%
}
\makeatother

\makeatletter
\newcommand{\addtitleinfo}{%
    \phantomsection%
    \addcontentsline{toc}{section}{\@title}}
\makeatother


\newcommand{\addpaper}[1]{%
    \addinfo%
    \includepdf[pages=-, pagecommand={\thispagestyle{plain}}]{#1}%
    \clearpage%
    %\cleardoublepage%
}

\providecommand{\function}[1]{\section{#1}}
\providecommand{\prototype}[1]{%
    \lstset{style=function}%
    \lstinline[language=C,breaklines]@#1@%
}


\providecommand{\datatype}[1]{%
    \lstset{style=datatype}%
    \begin{lstlisting}
    \protect #1
    \end{lstlisting}
}

\providecommand{\argument}[1]{\textit{#1}}



%--------------------------------------------------------------------
% placeholder function for "not yet ready" papers
%--------------------------------------------------------------------
\makeatletter
\providecommand{\placeholder}[1]{%
\addinfo%
\begin{flushleft}%
\sffamily
{\color{red}\hrule\bigskip}%
{\Large\bfseries\color{black}\@title\par}%
\medskip
{\itshape\color{black}\@author\par}%
{\bigskip\color{red}\hrule\vspace*{2pc}}%
\end{flushleft}%

\bigskip

\vspace*{30mm}
\noindent
\textbf{THIS PAGE IS A PLACEHOLDER FOR
% typeset file name in \url{} in order to support file names with underscores
\phantom{MMM}\textcolor{red}{\url{#1}},\phantom{MMM} A PAPER IN PREPARATION}\\[4em]
WHEN THE PDF OF THE PAPER IS READY:\\[2em]
CHANGE
\textcolor{red}{$\backslash$placeholder\{\url{#1}\}} TO
\textcolor{red}{$\backslash$addpaper\{\url{#1}\}}
IN \textcolor{red}{\jobname .tex}, and recompile.
}
\makeatother





%--------------------------------------------------------------------
% inline papers
%--------------------------------------------------------------------
\makeatletter
\providecommand{\inlinepaper}{%
\addinfo%
\begin{flushleft}%
\sffamily%
{\color{red}\hrule\bigskip}%
{\Large\bfseries\color{black}\@title\par}%
\medskip
{\itshape\color{black}\@author\par}%
{\bigskip\color{red}\hrule\vspace*{2pc}}%
\end{flushleft}%
\bigskip
}
\makeatother


%--------------------------------------------------------------------
% inline notes (i.e. material with title, but no author)
%--------------------------------------------------------------------
\makeatletter
\providecommand{\inlinenote}{%
\addtitleinfo%
\begin{flushleft}%
\sffamily%
{\color{red}\hrule\bigskip}%
{\Large\bfseries\color{black}\@title\par}%
{\bigskip\color{red}\hrule\vspace*{2pc}}%
\end{flushleft}%
\bigskip
}
\makeatother





%--------------------------------------------------------------------
% "Notat" style title blurb/colophon
%--------------------------------------------------------------------
\makeatletter
\renewcommand{\maketitle}{%
\begin{flushleft}%
\sffamily
{\color{white}\Huge\bfseries\@title\par}%
\bigskip
{\color{white}\normalsize\@author\par}%
\medskip
%{\@date\par}%
\end{flushleft}%
\thispagestyle{empty}%
}
\makeatother





% main text/everything in sans serif
\renewcommand\familydefault{\sfdefault}

% eliminate subsections from table of contents
\setcounter{tocdepth}{1}

% headlines in sans serif
\usepackage{sectsty}
\allsectionsfont{\fontfamily{phv}\selectfont}

\providecommand\technicalreporttext{TECHNICAL REPORT NO.\ }
\providecommand\reportnumber{XX}

%\definecolor[named]{KMSmain}{cmyk}{0.43,0.00,0.25,0.25}
%\definecolor[named]{KMSleft}{cmyk}{0.43,0.00,0.25,0.45}
%\definecolor[named]{KMSright}{cmyk}{0.43,0.00,0.25,0.80}
%\definecolor[named]{transparent}{hsb}{0,0,0}
\definecolor{KMSmain}{cmyk}{0.43,0.00,0.25,0.25}
%\definecolor{KMSmain}{cmyk}{1.00,0.20,0.50,0.30}
\definecolor{KMSleft}{cmyk}{0.43,0.00,0.25,0.45}
\definecolor{KMSright}{cmyk}{0.43,0.00,0.25,0.80}
\definecolor{transparent}{cmyk}{0,0,0,0}





% http://tex.stackexchange.com/questions/61627/prevent-action-if-top-of-page
\newcommand\disappearingrule{%
  \par % make sure we end a paragraph
  \vskip5pt % space above the rule
  \leaders\vrule width \textwidth\vskip0.4pt % rule thickness is 0.4pt
  \nointerlineskip % disable interline glue here
  \vskip5pt % space below the rule
}


% "Crayola" color definitions
% originally due to Tomas Rokick for his dvips definitions.

%\definecolor{GreenYellow}{cmyk}{0.15,0,0.69,0}     % PANTONE 388
%\definecolor{Yellow}{cmyk}{0,0,1.,0}               % PANTONE YELLOW
%\definecolor{Goldenrod}{cmyk}{0,0.10,0.84,0}       % PANTONE 109
%\definecolor{Dandelion}{cmyk}{0,0.29,0.84,0}       % PANTONE 123
%\definecolor{Apricot}{cmyk}{0,0.32,0.52,0}         % PANTONE 1565
%\definecolor{Peach}{cmyk}{0,0.50,0.70,0}           % PANTONE 164
%\definecolor{Melon}{cmyk}{0,0.46,0.50,0}           % PANTONE 177
%\definecolor{YellowOrange}{cmyk}{0,0.42,1.,0}      % PANTONE 130
%\definecolor{Orange}{cmyk}{0,0.61,0.87,0}          % PANTONE ORANGE-021
%\definecolor{BurntOrange}{cmyk}{0,0.51,1.,0}       % PANTONE 388
%\definecolor{Bittersweet}{cmyk}{0,0.75,1.,0.24}    % PANTONE 167
%\definecolor{RedOrange}{cmyk}{0,0.77,0.87,0}       % PANTONE 179
%\definecolor{Mahogany}{cmyk}{0,0.85,0.87,0.35}     % PANTONE 484
%\definecolor{Maroon}{cmyk}{0,0.87,0.68,0.32}       % PANTONE 201
%\definecolor{BrickRed}{cmyk}{0,0.89,0.94,0.28}     % PANTONE 1805
%\definecolor{Red}{cmyk}{0,1.,1.,0}                 % PANTONE RED
%\definecolor{OrangeRed}{cmyk}{0,1.,0.50,0}         % No PANTONE,match
%\definecolor{RubineRed}{cmyk}{0,1.,0.13,0}         % PANTONE RUBINE-RED
%\definecolor{WildStrawberry}{cmyk}{0,0.96,0.39,0}  % PANTONE 206
%\definecolor{Salmon}{cmyk}{0,0.53,0.38,0}          % PANTONE 183
%\definecolor{CarnationPink}{cmyk}{0,0.63,0,0}      % PANTONE 218
%\definecolor{Magenta}{cmyk}{0,1.,0,0}              % PANTONE PROCESS-MAGENTA
%\definecolor{VioletRed}{cmyk}{0,0.81,0,0}          % PANTONE 219
%\definecolor{Rhodamine}{cmyk}{0,0.82,0,0}          % PANTONE RHODAMINE-RED
%\definecolor{Mulberry}{cmyk}{0.34,0.90,0,0.02}     % PANTONE 241
%\definecolor{RedViolet}{cmyk}{0.07,0.90,0,0.34}    % PANTONE 234
%\definecolor{Fuchsia}{cmyk}{0.47,0.91,0,0.08}      % PANTONE 248
%\definecolor{Lavender}{cmyk}{0,0.48,0,0}           % PANTONE 223
%\definecolor{Thistle}{cmyk}{0.12,0.59,0,0}         % PANTONE 245
%\definecolor{Orchid}{cmyk}{0.32,0.64,0,0}          % PANTONE 252
%\definecolor{DarkOrchid}{cmyk}{0.40,0.80,0.20,0}   %  No PANTONE match
%\definecolor{Purple}{cmyk}{0.45,0.86,0,0}          % PANTONE PURPLE
%\definecolor{Plum}{cmyk}{0.50,1.,0,0}              % PANTONE 518
%\definecolor{Violet}{cmyk}{0.79,0.88,0,0}          % PANTONE VIOLET
%\definecolor{RoyalPurple}{cmyk}{0.75,0.90,0,0}     % PANTONE 267
%\definecolor{BlueViolet}{cmyk}{0.86,0.91,0,0.04}   % PANTONE 2755
%\definecolor{Periwinkle}{cmyk}{0.57,0.55,0,0}      % PANTONE 2715
%\definecolor{CadetBlue}{cmyk}{0.62,0.57,0.23,0}    % PANTONE (534+535)
%\definecolor{CornflowerBlue}{cmyk}{0.65,0.13,0,0}  % PANTONE 292
%\definecolor{MidnightBlue}{cmyk}{0.98,0.13,0,0.43} % PANTONE 302
%\definecolor{NavyBlue}{cmyk}{0.94,0.54,0,0}        % PANTONE 293
%\definecolor{RoyalBlue}{cmyk}{1.,0.50,0,0}         % No PANTONE match
%\definecolor{Blue}{cmyk}{1.,1.,0,0}                % PANTONE BLUE-072
%\definecolor{Cerulean}{cmyk}{0.94,0.11,0,0}        % PANTONE 3005
%\definecolor{Cyan}{cmyk}{1.,0,0,0}                 % PANTONE PROCESS-CYAN
%\definecolor{ProcessBlue}{cmyk}{0.96,0,0,0}        % PANTONE PROCESS-BLUE
%\definecolor{SkyBlue}{cmyk}{0.62,0,0.12,0}         % PANTONE 2985
%\definecolor{Turquoise}{cmyk}{0.85,0,0.20,0}       % PANTONE (312+313)
%\definecolor{TealBlue}{cmyk}{0.86,0,0.34,0.02}     % PANTONE 3145
%\definecolor{Aquamarine}{cmyk}{0.82,0,0.30,0}      % PANTONE 3135
%\definecolor{BlueGreen}{cmyk}{0.85,0,0.33,0}       % PANTONE 320
%\definecolor{Emerald}{cmyk}{1.,0,0.50,0}           % No PANTONE match
%\definecolor{JungleGreen}{cmyk}{0.99,0,0.52,0}     % PANTONE 328
%\definecolor{SeaGreen}{cmyk}{0.69,0,0.50,0}        % PANTONE 3268
%\definecolor{Green}{cmyk}{1.,0,1.,0}               % PANTONE GREEN
%\definecolor{ForestGreen}{cmyk}{0.91,0,0.88,0.12}  % PANTONE 349
%\definecolor{PineGreen}{cmyk}{0.92,0,0.59,0.25}    % PANTONE 323
%\definecolor{LimeGreen}{cmyk}{0.50,0,1.,0}         % No PANTONE match
%\definecolor{YellowGreen}{cmyk}{0.44,0,0.74,0}     % PANTONE 375
%\definecolor{SpringGreen}{cmyk}{0.26,0,0.76,0}     % PANTONE 381
%\definecolor{OliveGreen}{cmyk}{0.64,0,0.95,0.40}   % PANTONE 582
%\definecolor{RawSienna }{cmyk}{0,0.72,1.,0.45}     % PANTONE 154
%\definecolor{Sepia}{cmyk}{0,0.83,1.,0.70}          % PANTONE 161
%\definecolor{Brown}{cmyk}{0,0.81,1.,0.60}          % PANTONE 1615
%\definecolor{Tan}{cmyk}{0.14,0.42,0.56,0}          % No PANTONE match
%\definecolor{Gray}{cmyk}{0,0,0,0.50}               % PANTONE COOL-GRAY-8
%\definecolor{Black}{cmyk}{0,0,0,1.}                % PANTONE PROCESS-BLACK
%\definecolor{White}{cmyk}{0,0,0,0}                 % No PANTONE match











%--------------------------------------------------------------------
% this creates the header and removes pagination for the first page
%--------------------------------------------------------------------
\AtBeginDocument{%
\null\thispagestyle{empty}%
%
% MAIN BLOCK AND TITLE/AUTHOR BLURB
\begin{textblock}{190}(10,10)%
\textblockcolor{KMSmain}%
\rule{0mm}{250mm}%
\end{textblock}%
\begin{textblock}{150}(30,155)%
\textblockcolor{KMSmain}%
\maketitle%
\end{textblock}%
%
% NAUTICAL CHART
\begin{textblock}{210}(0,0)%
\textblockcolor{}%
%                                                        left bottom  right top
%%%%%%%%%%%%%%%%%%%%%\noindent\includegraphics[width=210mm, height=75mm, trim=20mm 70mm    20mm  15mm, clip=true]{nav.pdf}%
\end{textblock}%
%
% THEMATIC IMAGE
\begin{textblock}{210}(0,75)%
\textblockcolor{white}%
%%%%%%%%%%%%%%%%%%%%%%\noindent\includegraphics[width=210mm]{\imagefile}%
\end{textblock}%

%
% LEFT STRIP: MONOCHROME
\begin{textblock}{190}(10,75)%
\textblockcolor{KMSleft}%
\vrule width 0mm depth 5mm height 5mm%
\end{textblock}%
%
% RIGHT STRIP: TECNICAL REPORT NO. XX
\begin{textblock}{70}(130,75)%
\textblockcolor{KMSright}%
\begin{centering}%
\rule[0mm]{0mm}{10mm}%
\raisebox{5mm-\totalheight/2}{\color{white}\large\bfseries\sffamily \technicalreporttext \reportnumber}\par%
\end{centering}%
\end{textblock}%
%
% KMS/MIM LOGO
\begin{textblock}{80}(120,265)%
\textblockcolor{white}%
%\noindent\includegraphics[width=60mm]{KMS_uk_rgb.pdf}
%\noindent\includegraphics[width=60mm]{kmsmim.pdf}%
%%%%%%%%%%%%%%\noindent\includegraphics[width=80mm]{MIE_Nsc_rgb_jpg_UK.jpg}%
\end{textblock}%
%
\null%
\clearpage%
%
}




%--------------------------------------------------------------------
% back cover
%--------------------------------------------------------------------
\AtEndDocument{
\null\thispagestyle{empty}%

% MAIN BLOCK AND KMS ADDRESS BLURB
\begin{textblock}{190}(10,10)%
\textblockcolor{KMSmain}
\rule{0mm}{257mm}
\end{textblock}

%\begin{textblock}{100}(20,237)%
\begin{textblock}{100}(10,273)%
\textblockcolor{white}
%\color{white}
\color{KMSmain}
\noindent
\textsf{%
\bf%
Danish Geodata Agency\\
Copenhagen, Denmark\\
http://www.gst.dk
}
\end{textblock}

% NAUTICAL CHART
\begin{textblock}{210}(0,0)%
\textblockcolor{}%
%%%%%%%%%%%%%%%%%%%%%%%%%\noindent\includegraphics[width=210mm, height=75mm, trim=20mm 70mm 20mm 15mm, clip=true]{nav.pdf}
\end{textblock}



% LEFT STRIP: MONOCHROME
\begin{textblock}{190}(10,75)%
\textblockcolor{KMSleft}
\vrule width 0mm depth 5mm height 5mm
\end{textblock}




% KMS/CROWN LOGO
\begin{textblock}{20}(180,272)%
\textblockcolor{white}%
%\noindent\includegraphics[width=60mm]{KMS_uk_rgb.pdf}
%%%%%%%%%%%%%%%%%%%%%\null\hfill\includegraphics[height=15mm]{kmskroneny.png}
\end{textblock}
\null


}


